this.BX=this.BX||{},function(t){"use strict";var e=function(){function t(t){this.root=document.querySelector(t),this.sortItems=document.querySelectorAll(".smart-filter__sort"),this.container=document.querySelector("[data-container]"),this.target=this.container.querySelector("[data-target]"),this.pagination=this.container.querySelector("[data-pagination]"),this.filter=document.querySelector("[data-filter]"),this.root&&this.initFilter(),0!==this.sortItems.length&&this.initSort()}var e=t.prototype;return e.initSort=function(){var t=this;this.sorts=document.querySelectorAll(".smart-filter__sort"),this.sorts.length&&[].forEach.call(this.sorts,(function(e){e.addEventListener("change",t.changeSortItem.bind(t))})),this.clearSortItem()},e.changeSortItem=function(t){void 0===t&&(t=new Event("change"));var e=t.target||t.currentTarget,r=this,a=new URLSearchParams(window.location.search),i=a.get("sort_by"),n=a.get("sort_order"),o="desc";this.clearSortItem(),i||(e.checked=!0),"desc"===n&&(o="asc");var s="?sort_by="+e.name+"&sort_order="+o;BX.ajax({url:s,method:"GET",dataType:"html",scriptsRunFirst:!1,emulateOnload:!1,cache:!1,processData:!1,onsuccess:function(t){var e=document.createElement("span");e.insertAdjacentHTML("afterbegin",t);var a=e.querySelector("#blog-card"),i=document.querySelector("#blog-card");a&&(i.innerHTML=a.innerHTML);var n=e.querySelector('[data-container="blog-list"]').querySelector("[data-pagination]");n&&r.pagination?r.pagination.innerHTML=n.innerHTML:n&&!r.pagination&&r.target?r.target.after(n):!n&&this.pagination&&r.pagination.remove(),window.AjaxPagination&&window.AjaxPagination.length&&window.AjaxPagination.forEach((function(t){t.target&&"blog-card"===t.target.id&&t.init()})),history.pushState({},"",s)}}),this.clearSortItem(e.name,o)},e.clearSortItem=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var r=new URLSearchParams(window.location.search),a=r.get("sort_by"),i=r.get("sort_order"),n=document.querySelectorAll(".smart-filter__sort");e&&(i=e),t&&(a=t),a||(a=n[0].name,n[0].closest(".smart-filter__item").querySelector(".smart-filter__label_sort").classList.add("sort-up")),n.forEach((function(t){var e=t.closest(".smart-filter__item").querySelector(".smart-filter__label_sort");t.name===a?(t.checked=!0,"asc"===i&&(e.classList.add("sort-up"),e.classList.remove("sort-down")),"desc"===i&&(e.classList.add("sort-down"),e.classList.remove("sort-up"))):(t.checked=!1,e.classList.remove("sort-up"),e.classList.remove("sort-down"))}))},e.initFilter=function(){var t=this;this.items=this.root.querySelectorAll("[data-filter-item]"),this.clears=this.root.querySelectorAll("[data-filter-clear]"),this.items.length&&[].forEach.call(this.items,(function(e){e.addEventListener("change",t.changeFilterItem.bind(t))})),this.clears.length&&[].forEach.call(this.clears,(function(e){e.addEventListener("change",t.clearClickHandler.bind(t))}))},e.clearClickHandler=function(t){var e=t.target||t.currentTarget,r=e.dataset.filterClear;"checkbox"===e.type&&(e.checked=!0);var a=[];[].forEach.call(this.items,(function(t){t.dataset.filterItem===r&&a.push(t)})),[].forEach.call(a,(function(t){t.checked=!1})),this.changeFilterItem()},e.changeFilterItem=function(t){var e=this;void 0===t&&(t=new Event("change")),this.dispatchStartEvent();var r=t.target||t.currentTarget,a=new BX.ajax.FormData;if(a.append("ajax","y"),[].forEach.call(this.items,(function(t,e){if("checkbox"===t.type)t.checked&&a.append(t.name,t.value);else t.value.length>0&&a.append(t.name,t.value)})),r){var i=r.dataset.filterItem;this.root.querySelector('[data-filter-clear="'+i+'"]').checked=!1}a.send(window.location.href,(function(t){e.dispatchEndEvent(JSON.parse(t))}))},e.dispatchStartEvent=function(){var t=new CustomEvent("before.smart.filter");document.dispatchEvent(t)},e.dispatchEndEvent=function(t){var e=new CustomEvent("after.smart.filter",{detail:t});document.dispatchEvent(e)},t}();t.Smartfilter=e}(this.BX.Izifir=this.BX.Izifir||{});
//# sourceMappingURL=smartfilter.bundle.js.map
