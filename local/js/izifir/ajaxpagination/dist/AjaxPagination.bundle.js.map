{"version":3,"file":"AjaxPagination.bundle.js","sources":["../src/AjaxPagination.js"],"sourcesContent":["import './style/style.scss'\r\nimport 'main.core'\r\n\r\nexport class AjaxPagination\r\n{\r\n    constructor (id)\r\n    {\r\n        this.id = id\r\n        this.init()\r\n    }\r\n\r\n    init()\r\n    {\r\n        this.link = document.querySelector('[data-pagination-link=' + this.id + ']')\r\n        if (this.link) {\r\n            this.container = null\r\n            this.target = null\r\n            this.pagination = null\r\n\r\n            this.container = this.link.closest('[data-container]')\r\n            this.link.removeEventListener('click', this.linkClickHandler.bind(this))\r\n            this.link.addEventListener('click', this.linkClickHandler.bind(this))\r\n\r\n            if (this.container) {\r\n                this.target = this.container.querySelector('[data-target]')\r\n                this.pagination = this.container.querySelector('[data-pagination]')\r\n            }\r\n        }\r\n    }\r\n\r\n    linkClickHandler(evt = new Event('click'))\r\n    {\r\n        evt.preventDefault()\r\n        const self = this\r\n        const link = evt.currentTarget || evt.target\r\n        const url = link.href\r\n\r\n        if (!link.classList.contains('is-loading')) {\r\n            link.classList.add('is-loading')\r\n\r\n            BX.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                dataType: 'html',\r\n                scriptsRunFirst: false,\r\n                emulateOnload: false,\r\n                cache: false,\r\n                processData: false,\r\n                onsuccess (data)\r\n                {\r\n                    const fragment = document.createElement('span')\r\n                    fragment.insertAdjacentHTML('afterbegin', data)\r\n                    const container = fragment.querySelector('[data-container=\"' + self.container.dataset.container + '\"]')\r\n                    const newTarget = container.querySelector('[data-target=\"' + self.target.dataset.target + '\"]')\r\n                    const newPagination = container.querySelector('[data-pagination]')\r\n\r\n                    if (newTarget) {\r\n                        self.target.insertAdjacentHTML('beforeend', newTarget.innerHTML)\r\n                    }\r\n\r\n                    if (newPagination) {\r\n                        self.pagination.innerHTML = newPagination.innerHTML\r\n                        self.init()\r\n                    } else {\r\n                        self.pagination.remove()\r\n                    }\r\n\r\n                    const event = new CustomEvent('ajax.pagination.loaded')\r\n                    document.dispatchEvent(event)\r\n\r\n                    link.classList.remove('is-loading')\r\n                }\r\n            })\r\n        }\r\n    }\r\n}"],"names":["AjaxPagination","id","this","init","_proto","link","document","querySelector","container","target","pagination","closest","removeEventListener","linkClickHandler","bind","addEventListener","evt","Event","preventDefault","self","currentTarget","url","href","classList","contains","add","BX","ajax","method","dataType","scriptsRunFirst","emulateOnload","cache","processData","onsuccess","data","fragment","createElement","insertAdjacentHTML","dataset","newTarget","newPagination","innerHTML","remove","event","CustomEvent","dispatchEvent"],"mappings":"iDAGaA,aAET,WAAaC,GAETC,KAAKD,GAAKA,EACVC,KAAKC,OACR,kBAiEA,OAjEAC,EAEDD,KAAA,WAEID,KAAKG,KAAOC,SAASC,cAAc,yBAA2BL,KAAKD,GAAK,KACpEC,KAAKG,OACLH,KAAKM,UAAY,KACjBN,KAAKO,OAAS,KACdP,KAAKQ,WAAa,KAElBR,KAAKM,UAAYN,KAAKG,KAAKM,QAAQ,oBACnCT,KAAKG,KAAKO,oBAAoB,QAASV,KAAKW,iBAAiBC,KAAKZ,OAClEA,KAAKG,KAAKU,iBAAiB,QAASb,KAAKW,iBAAiBC,KAAKZ,OAE3DA,KAAKM,YACLN,KAAKO,OAASP,KAAKM,UAAUD,cAAc,iBAC3CL,KAAKQ,WAAaR,KAAKM,UAAUD,cAAc,wBAG1DH,EAEDS,iBAAA,SAAiBG,YAAAA,IAAAA,EAAM,IAAIC,MAAM,UAE7BD,EAAIE,iBACJ,IAAMC,EAAOjB,KACPG,EAAOW,EAAII,eAAiBJ,EAAIP,OAChCY,EAAMhB,EAAKiB,KAEZjB,EAAKkB,UAAUC,SAAS,gBACzBnB,EAAKkB,UAAUE,IAAI,cAEnBC,GAAGC,KAAK,CACJN,IAAKA,EACLO,OAAQ,MACRC,SAAU,OACVC,iBAAiB,EACjBC,eAAe,EACfC,OAAO,EACPC,aAAa,EACbC,mBAAWC,GAEP,IAAMC,EAAW9B,SAAS+B,cAAc,QACxCD,EAASE,mBAAmB,aAAcH,GAC1C,IAAM3B,EAAY4B,EAAS7B,cAAc,oBAAsBY,EAAKX,UAAU+B,QAAQ/B,UAAY,MAC5FgC,EAAYhC,EAAUD,cAAc,iBAAmBY,EAAKV,OAAO8B,QAAQ9B,OAAS,MACpFgC,EAAgBjC,EAAUD,cAAc,qBAE1CiC,GACArB,EAAKV,OAAO6B,mBAAmB,YAAaE,EAAUE,WAGtDD,GACAtB,EAAKT,WAAWgC,UAAYD,EAAcC,UAC1CvB,EAAKhB,QAELgB,EAAKT,WAAWiC,SAGpB,IAAMC,EAAQ,IAAIC,YAAY,0BAC9BvC,SAASwC,cAAcF,GAEvBvC,EAAKkB,UAAUoB,OAAO,oBAIrC"}