{"version":3,"file":"BlogList.bundle.js","sources":["../src/BlogList.js"],"sourcesContent":["import {Blockblog} from 'izifir.blockblog';\r\nimport {CaseAll} from 'izifir.case_all';\r\nimport './style/style.scss';\r\nimport {Smartfilter} from \"izifir.smartfilter\";\r\n\r\nexport class BlogList\r\n{\r\n    constructor ()\r\n    {\r\n        this.container = document.querySelector('[data-container=\"blog-list\"]');\r\n        this.target = this.container.querySelector('[data-target]');\r\n        this.pagination = this.container.querySelector('[data-pagination]');\r\n        this.filter = document.querySelector('.smart-filter');\r\n\r\n        document.addEventListener('before.smart.filter', this.beforeSmartFilterHandler.bind(this));\r\n        document.addEventListener('after.smart.filter', this.afterSmartFilterHandler.bind(this));\r\n        window.addEventListener('popstate', this.onPopState.bind(this));\r\n    }\r\n\r\n    beforeSmartFilterHandler ()\r\n    {\r\n        this.container.classList.add('f-loading');\r\n        this.filter.closest('[data-filter]').classList.add('f-loading');\r\n    }\r\n\r\n    afterSmartFilterHandler (evt = new CustomEvent('after.smart.filter'))\r\n    {\r\n        const url = evt.detail.FILTER_AJAX_URL + window.location.search;\r\n        BX.ajax({\r\n            url: url,\r\n            dataType: 'html',\r\n            onsuccess: (response) => {\r\n\r\n                if (!evt.detail.step) {\r\n                    history.pushState({}, '', url);\r\n                }\r\n\r\n                const fragment = document.implementation.createHTMLDocument();\r\n                if (response.toLowerCase().indexOf('<!doctype') > -1) {\r\n                    fragment.documentElement.innerHTML = response;\r\n                } else {\r\n                    fragment.body.innerHTML = response;\r\n                }\r\n\r\n                const container = fragment.querySelector('[data-container=\"blog-list\"]');\r\n\r\n                const filter = fragment.querySelector('.smart-filter__container');\r\n                document.querySelector('.smart-filter__container').innerHTML = filter.innerHTML;\r\n\r\n                if (container) {\r\n                    const target = container.querySelector('[data-target]');\r\n                    this.target.innerHTML = target.innerHTML;\r\n\r\n                    const pagination = container.querySelector('[data-pagination]');\r\n                    if (pagination && this.pagination) {\r\n                        this.pagination.innerHTML = pagination.innerHTML;\r\n                    } else if (pagination && !this.pagination && this.target) {\r\n                        this.target.after(pagination);\r\n                    } else if (!pagination && this.pagination) {\r\n                        this.pagination.remove();\r\n                    }\r\n\r\n                    if (window.Smartfilter) {\r\n                        window.Smartfilter.initFilter();\r\n                        window.Smartfilter.clearSortItem();\r\n                    }\r\n\r\n                    if (window.AjaxPagination && window.AjaxPagination.length) {\r\n                        window.AjaxPagination.forEach((pager) => {\r\n                            if (pager.target && pager.target.id === 'blog-card') {\r\n                                pager.init();\r\n                            }\r\n                        })\r\n                    }\r\n                }\r\n\r\n                this.container.classList.remove('f-loading', 'is-visible');\r\n                this.filter.closest('[data-filter]').classList.remove('f-loading', 'is-visible');\r\n            }\r\n        });\r\n    }\r\n\r\n    onPopState (event)\r\n    {\r\n        this.afterSmartFilterHandler(new CustomEvent('after.smart.filter', {\r\n            detail: {\r\n                'FILTER_AJAX_URL': document.location.href,\r\n                'step': true\r\n            }\r\n        }));\r\n    }\r\n}"],"names":["BlogList","this","container","document","querySelector","target","pagination","filter","addEventListener","beforeSmartFilterHandler","bind","afterSmartFilterHandler","window","onPopState","_proto","classList","add","closest","evt","CustomEvent","url","detail","FILTER_AJAX_URL","location","search","BX","ajax","dataType","onsuccess","response","step","history","pushState","fragment","implementation","createHTMLDocument","toLowerCase","indexOf","documentElement","innerHTML","body","_this","after","remove","Smartfilter","initFilter","clearSortItem","AjaxPagination","length","forEach","pager","id","init","event","href"],"mappings":"uDAKaA,aAET,aAEIC,KAAKC,UAAYC,SAASC,cAAc,gCACxCH,KAAKI,OAASJ,KAAKC,UAAUE,cAAc,iBAC3CH,KAAKK,WAAaL,KAAKC,UAAUE,cAAc,qBAC/CH,KAAKM,OAASJ,SAASC,cAAc,iBAErCD,SAASK,iBAAiB,sBAAuBP,KAAKQ,yBAAyBC,KAAKT,OACpFE,SAASK,iBAAiB,qBAAsBP,KAAKU,wBAAwBD,KAAKT,OAClFW,OAAOJ,iBAAiB,WAAYP,KAAKY,WAAWH,KAAKT,OAC5D,kBAyEA,OAzEAa,EAEDL,yBAAA,WAEIR,KAAKC,UAAUa,UAAUC,IAAI,aAC7Bf,KAAKM,OAAOU,QAAQ,iBAAiBF,UAAUC,IAAI,cACtDF,EAEDH,wBAAA,SAAyBO,GACzB,oBADyBA,IAAAA,EAAM,IAAIC,YAAY,uBAE3C,IAAMC,EAAMF,EAAIG,OAAOC,gBAAkBV,OAAOW,SAASC,OACzDC,GAAGC,KAAK,CACJN,IAAKA,EACLO,SAAU,OACVC,UAAW,SAACC,GAEHX,EAAIG,OAAOS,MACZC,QAAQC,UAAU,GAAI,GAAIZ,GAG9B,IAAMa,EAAW9B,SAAS+B,eAAeC,qBACrCN,EAASO,cAAcC,QAAQ,cAAgB,EAC/CJ,EAASK,gBAAgBC,UAAYV,EAErCI,EAASO,KAAKD,UAAYV,EAG9B,IAAM3B,EAAY+B,EAAS7B,cAAc,gCAEnCG,EAAS0B,EAAS7B,cAAc,4BAGtC,GAFAD,SAASC,cAAc,4BAA4BmC,UAAYhC,EAAOgC,UAElErC,EAAW,CACX,IAAMG,EAASH,EAAUE,cAAc,iBACvCqC,EAAKpC,OAAOkC,UAAYlC,EAAOkC,UAE/B,IAAMjC,EAAaJ,EAAUE,cAAc,qBACvCE,GAAcmC,EAAKnC,WACnBmC,EAAKnC,WAAWiC,UAAYjC,EAAWiC,UAChCjC,IAAemC,EAAKnC,YAAcmC,EAAKpC,OAC9CoC,EAAKpC,OAAOqC,MAAMpC,IACVA,GAAcmC,EAAKnC,YAC3BmC,EAAKnC,WAAWqC,SAGhB/B,OAAOgC,cACPhC,OAAOgC,YAAYC,aACnBjC,OAAOgC,YAAYE,iBAGnBlC,OAAOmC,gBAAkBnC,OAAOmC,eAAeC,QAC/CpC,OAAOmC,eAAeE,SAAQ,SAACC,GACvBA,EAAM7C,QAA8B,cAApB6C,EAAM7C,OAAO8C,IAC7BD,EAAME,UAMtBX,EAAKvC,UAAUa,UAAU4B,OAAO,YAAa,cAC7CF,EAAKlC,OAAOU,QAAQ,iBAAiBF,UAAU4B,OAAO,YAAa,kBAG9E7B,EAEDD,WAAA,SAAYwC,GAERpD,KAAKU,wBAAwB,IAAIQ,YAAY,qBAAsB,CAC/DE,OAAQ,CACJC,gBAAmBnB,SAASoB,SAAS+B,KACrCxB,MAAQ,QAGnB"}